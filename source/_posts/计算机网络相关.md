---
title: 计算机网络相关
date: 2018-12-07 16:18:29
tags: network
categories: network
---

记录计算机网络原理，流量分析相关。

<!--more-->

## 使用tshark过滤HTTPS流量

```POWERSHELL
foreach($f in gci pcaps *pcap)
{
	tshark -r $f.FullName -Y "tcp.port==443" -F pcap -w filtered_pcap\$($f.BaseName).pcap
	echo finised:($f.BaseName)
}
```

- -r：表示加载本地文件
- -Y：表示过滤条件，这里过滤条件是443端口
- -F：表示存储的格式，这里指定pcap，如果指定为pcapng则SplitCap不能加载
- -w：表示存储文件

## 使用SplitCap切分流

```powershell
foreach($f in gci 1_Pcap *.pcap)
{
    SplitCap -p 100000 -b 100000 -r $f.FullName -o 2_Session\AllLayers\$($f.BaseName)-ALL
    SplitCap -p 100000 -b 100000 -r $f.FullName -s flow -o 2_Session\AllLayers\$($f.BaseName)-ALL
    
    gci 2_Session\AllLayers\$($f.BaseName)-ALL | ?{$_.Length -eq 0} | del

    SplitCap -p 100000 -b 100000 -r $f.FullName -o 2_Session\L7\$($f.BaseName)-L7 -y L7
    SplitCap -p 100000 -b 100000 -r $f.FullName -s flow -o 2_Session\L7\$($f.BaseName)-L7 -y L7

    gci 2_Session\L7\$($f.BaseName)-L7 | ?{$_.Length -eq 0} | del
}

finddupe -del 2_Session\AllLayers
finddupe -del 2_Session\L7
```

